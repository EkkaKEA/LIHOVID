Перем  i;
Перем  j;

//_____________________________________________________________________________


Функция ВыделитьСлово(ИсходнаяСтрока)
	
	Буфер = СокрЛ(ИсходнаяСтрока);
	ПозицияПослПробела = Найти(Буфер, " ");

	Если ПозицияПослПробела = 0 Тогда
		ИсходнаяСтрока = "";
		Возврат Буфер;
	КонецЕсли;
	
	ВыделенноеСлово = СокрЛП(Лев(Буфер, ПозицияПослПробела));
	ИсходнаяСтрока = Сред(ИсходнаяСтрока, ПозицияПослПробела + 1);
	
	Возврат ВыделенноеСлово;
	
КонецФункции


Процедура Кнопка1Нажатие(Элемент)
начало11=НачалоГода('2011-01-01');	
начало12=НачалоГода('2012-01-01');
начало31=НачалоДня('2011-12-31');
ВыборкаДокументов = Документы.УчетГСМ.Выбрать(НачалоДня(НачПериода), КонецДня(КонПериода));
    
    Пока ВыборкаДокументов.Следующий() Цикл
       
    ИскомыйДокумент = ВыборкаДокументов.ПолучитьОбъект();
	началоЗаправки=НачалоГода(ИскомыйДокумент.ДатаЗаправки);
	началоДокумента=НачалоГода(ИскомыйДокумент.Дата);
	Если (началоЗаправки<>начало11) или (началоДокумента<>начало12) Тогда Продолжить; КонецЕсли;
	Сообщить( ИскомыйДокумент);
    Сообщить( СТрока(ИскомыйДокумент.ДатаЗаправки)+"/"+Строка(ИскомыйДокумент.Дата));

	

	
	//Для каждого СтрТабЧасти из ИскомыйДокумент.Услуги Цикл
	//  Сообщить(Строка(СтрТабЧасти.Содержание)+"//"+Строка(СтрТабЧасти.Количество));
	//	//    ...

	//	//Если ТекущаяСтрока.СубконтоДт или ТекущаяСтрока.СубконтоКт = Справочники.ПодразделенияОрганизаций.НайтиПоКоду("000000008") тогда
	//	//   
	//		СтрТабЧасти.ПодразделениеЗатрат = Справочники.ПодразделенияОрганизаций.НайтиПоКоду("000000003") ;
	//	//   
	//	//КонецЕсли;   
	//КонецЦикла;	
		// 
	ИскомыйДокумент.Дата = начало31;	
	ИскомыйДокумент.Записать(РежимЗаписиДокумента.Проведение);
	
       
КонецЦикла ;
Сообщить("Закончил");
КонецПроцедуры


Процедура ОбработкаСФВыданный(Элемент)
ВыборкаДокументов = Документы.СчетФактураВыданный.Выбрать(НачалоДня(НачПериода), КонецДня(КонПериода));
    
    Пока ВыборкаДокументов.Следующий() Цикл
       
    ИскомыйДокумент = ВыборкаДокументов.ПолучитьОбъект();
	ЕстьКод=СокрЛП(ИскомыйДокумент.КодВидаОперации);
//	Если (ЕстьКод<>"") Тогда Продолжить; КонецЕсли;
попытка
	ИскомыйДокумент.КодВидаОперации = "01";
	ИскомыйДокумент.КодСпособаВыставления = 1;
	ИскомыйДокумент.Выставлен = Истина;
	ИскомыйДокумент.ДатаВыставления = ИскомыйДокумент.Дата;

	ИскомыйДокумент.Записать(РежимЗаписиДокумента.Проведение);
	Сообщить( ИскомыйДокумент);
	Сообщить( СокрЛП(ИскомыйДокумент.КодВидаОперации));
исключение
	Сообщить("ошибочки");
КонецПопытки;	
	

	
	//Для каждого СтрТабЧасти из ИскомыйДокумент.Услуги Цикл
	//  Сообщить(Строка(СтрТабЧасти.Содержание)+"//"+Строка(СтрТабЧасти.Количество));
	//	//    ...

	//	//Если ТекущаяСтрока.СубконтоДт или ТекущаяСтрока.СубконтоКт = Справочники.ПодразделенияОрганизаций.НайтиПоКоду("000000008") тогда
	//	//   
	//		СтрТабЧасти.ПодразделениеЗатрат = Справочники.ПодразделенияОрганизаций.НайтиПоКоду("000000003") ;
	//	//   
	//	//КонецЕсли;   
	//КонецЦикла;	
		// 
	
       
	КонецЦикла ;
	Сообщить("Закончил");

КонецПроцедуры

Процедура ОбработкаСФПолученный(Элемент)
ВыборкаДокументов = Документы.СчетФактураПолученный.Выбрать(НачалоДня(НачПериода), КонецДня(КонПериода));
    
    Пока ВыборкаДокументов.Следующий() Цикл
       
    ИскомыйДокумент = ВыборкаДокументов.ПолучитьОбъект();
	ЕстьКод=СокрЛП(ИскомыйДокумент.КодВидаОперации);
	Если (ЕстьКод<>"") Тогда Продолжить; КонецЕсли;
	ИскомыйДокумент.КодВидаОперации = "01";	
	ИскомыйДокумент.КодСпособаПолучения = 1;	
	ИскомыйДокумент.Записать(РежимЗаписиДокумента.Проведение);
	Сообщить( ИскомыйДокумент);
	Сообщить( СокрЛП(ИскомыйДокумент.КодВидаОперации));

	

	
       
	КонецЦикла ;
	Сообщить("Закончил");

КонецПроцедуры

Процедура ОбработкаПоступленияРС(Элемент)
ВыборкаДокументов = Документы.ПоступлениеНаРасчетныйСчет.Выбрать(НачалоДня(НачПериода), КонецДня(КонПериода));
ПС = ПланыСчетов["Хозрасчетный"];
Счет9102      = ПС.ПрочиеРасходы;
Счет5703      = ПС.ПродажиПоПлатежнымКартам;



	Пока ВыборкаДокументов.Следующий() Цикл
	
	ИскомыйДокумент = ВыборкаДокументов.ПолучитьОбъект();
	Назн=СокрЛП(ИскомыйДокумент.НазначениеПлатежа);
	кафеесть=Найти (Назн,"070000095426");
	мойкаесть=Найти (Назн,"070000016122");
	Комиссияесть=Найти (Назн,"Комиссия");
попытка	
		Если кафеесть<>0 Тогда
		Комиссия = ВыделитьСлово(СокрЛП(Сред(Назн,Комиссияесть+8)));
		Комиссия = Лев(Комиссия,СтрДлина(Комиссия)-1);
		КомиссияЧ = Число(Комиссия);
		ИскомыйДокумент.ВидОперации=Перечисления.ВидыОперацийПоступлениеДенежныхСредств.ПоступленияОтПродажПоПлатежнымКартамИБанковскимКредитам;	

		Для каждого СтрТабЧасти из ИскомыйДокумент.РасшифровкаПлатежа Цикл
			 			 
			СтрТабЧасти.ДоговорКонтрагента = Справочники.ДоговорыКонтрагентов.НайтиПоКоду("000001727") ;
			СтрТабЧасти.СтатьяДвиженияДенежныхСредств = Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("000000055") ;
			СтрТабЧасти.СчетУчетаРасчетовСКонтрагентом = Счет5703;
			
//			Сообщить(Строка(ИскомыйДокумент.СубконтоКт1)+"//"+Строка(СтрТабЧасти.СубконтоКт1));
		КонецЦикла;	
		ИскомыйДокумент.СчетУчетаРасчетовСКонтрагентом = Счет9102;
		ИскомыйДокумент.СуммаУслуг=КомиссияЧ;
		ИскомыйДокумент.СубконтоКт1= Справочники.ПрочиеДоходыИРасходы.НайтиПоКоду("00058") ;
		ИскомыйДокумент.Записать(РежимЗаписиДокумента.Проведение);
	Сообщить("кафе //"+ ИскомыйДокумент );
		
	КонецЕсли;	
	
	Если мойкаесть<>0 Тогда
		Комиссия = ВыделитьСлово(СокрЛП(Сред(Назн,Комиссияесть+8)));
		Комиссия = Лев(Комиссия,СтрДлина(Комиссия)-1);
		КомиссияЧ = Число(Комиссия);
		ИскомыйДокумент.ВидОперации=Перечисления.ВидыОперацийПоступлениеДенежныхСредств.ПоступленияОтПродажПоПлатежнымКартамИБанковскимКредитам;	

		Для каждого СтрТабЧасти из ИскомыйДокумент.РасшифровкаПлатежа Цикл

			СтрТабЧасти.ДоговорКонтрагента = Справочники.ДоговорыКонтрагентов.НайтиПоКоду("000000924") ;
			СтрТабЧасти.СтатьяДвиженияДенежныхСредств = Справочники.СтатьиДвиженияДенежныхСредств.НайтиПоКоду("000000054") ;
			СтрТабЧасти.СчетУчетаРасчетовСКонтрагентом = Счет5703;
//			Сообщить(Строка(ИскомыйДокумент.СчетУчетаРасчетовСКонтрагентом)+"//"+Строка(СтрТабЧасти.СчетУчетаРасчетовСКонтрагентом));

		КонецЦикла;	
		ИскомыйДокумент.СчетУчетаРасчетовСКонтрагентом = Счет9102;
		ИскомыйДокумент.СуммаУслуг=КомиссияЧ;
		ИскомыйДокумент.СубконтоКт1= Справочники.ПрочиеДоходыИРасходы.НайтиПоКоду("00057") ;
		ИскомыйДокумент.Записать(РежимЗаписиДокумента.Проведение);
	Сообщить("мойка //"+ ИскомыйДокумент );
	КонецЕсли;	
	
	
//	Сообщить( Строка(кафеесть)+"/"+Строка(мойкаесть)+"/"+ИскомыйДокумент );
	исключение
	Сообщить("ошибочки");
КонецПопытки;	

		 
	КонецЦикла ;
	Сообщить("Закончил");


КонецПроцедуры


Процедура ВыбПериодНажатие(Элемент)
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	НастройкаПериода.УстановитьПериод(НачПериода, ?(КонПериода='0001-01-01', КонПериода, КонецДня(КонПериода)));
	Если НастройкаПериода.Редактировать() Тогда
		НачПериода = НачалоДня(НастройкаПериода.ПолучитьДатуНачала());
		КонПериода = КонецДня(НастройкаПериода.ПолучитьДатуОкончания());
	КонецЕсли;
	НадписьПериод = "" + ПредставлениеПериода(НачалоДня(НачПериода), КонецДня(КонПериода), "ФП = Истина");


КонецПроцедуры
//


ТекДата = ТекущаяДата();
НачПериода = НачалоДня(НачалоМесяца(ТекДата));
КонПериода = КонецДня(КонецМесяца(ТекДата));
НадписьПериод = "" + ПредставлениеПериода(НачалоДня(НачПериода), КонецДня(КонПериода), "ФП = Истина");
